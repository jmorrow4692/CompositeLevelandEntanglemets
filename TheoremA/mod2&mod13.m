////////////////////////////////////////////////////////////////////////////////////
// Computations for the mod 2 and mod 13 simultaneous computations
////////////////////////////////////////////////////////////////////////////////////

//From Zywina

_<t> := FunctionField(Rationals());



// ell=13
G13:=[
	sub<GL(2,13) | {[2,0,0,1],[1,1,0,1],[1,0,0,8]}>,
	sub<GL(2,13) | {[8,0,0,1],[1,1,0,1],[1,0,0,2]}>,
	sub<GL(2,13) | {[2,0,0,2],[1,1,0,1],[1,0,0,8]}>,
	sub<GL(2,13) | {[2,0,0,1],[1,1,0,1],[1,0,0,4]}>,
	sub<GL(2,13) | {[4,0,0,1],[1,1,0,1],[1,0,0,2]}>,
	sub<GL(2,13) | {[2,0,0,1],[1,1,0,1],[1,0,0,2]}>,
	sub<GL(2,13) | {[2,0,0,2], [2,0,0,3], [0,-1,1,0], [1,1,-1,1]}>
	];
H13:=[
	[],[],[],
	[sub<GL(2,13) | {[2,0,0,1], [1,0,0,2^4], [1,1,0,1]}>, sub<GL(2,13)| {[2^2,0,0,1], [1,0,0,2^4], [1,1,0,1], [2,0,0,4]}>],
	[sub<GL(2,13) | {[2^4,0,0,1], [1,0,0,2], [1,1,0,1]}>, sub<GL(2,13)| {[2^4,0,0,1], [1,0,0,2^2], [1,1,0,1], [4,0,0,2]}>],
	[], []
	];

P13:=[
	t^12+231*t^11+269*t^10-3160*t^9+6022*t^8-9616*t^7+21880*t^6-34102*t^5+28297*t^4-12455*t^3+2876*t^2-243*t+1,
	t^12-9*t^11+29*t^10-40*t^9+22*t^8-16*t^7+40*t^6-22*t^5-23*t^4+25*t^3-4*t^2-3*t+1,
	(t^4-t^3+2*t^2-9*t+3)*(3*t^4-3*t^3-7*t^2+12*t-4)*(4*t^4-4*t^3-5*t^2+3*t-1),
	t^8+235*t^7+1207*t^6+955*t^5+3840*t^4-955*t^3+1207*t^2-235*t+1,
	t^8-5*t^7+7*t^6-5*t^5+5*t^3+7*t^2+5*t+1,
	t^4+7*t^3+20*t^2+19*t+1
	];
Q13:=[
	t^12-512*t^11-13079*t^10-32300*t^9-104792*t^8-111870*t^7-419368*t^6+111870*t^5-104792*t^4+32300*t^3-13079*t^2+512*t+1,
	t^12-8*t^11+25*t^10-44*t^9+40*t^8+18*t^7-40*t^6-18*t^5+40*t^4+44*t^3+25*t^2+8*t+1
	];
J13:=[
	(t^2-t+1)^3*P13[1]^3/((t-1)*t*(t^3-4*t^2+t+1)^13),
	(t^2-t+1)^3*P13[2]^3/((t-1)^13*t^13*(t^3-4*t^2+t+1)),
	-13^4*(t^2-t+1)^3*P13[3]^3/((t^3-4*t^2+t+1)^13*(5*t^3-7*t^2-8*t+5)),
	(t^4-t^3+5*t^2+t+1)*P13[4]^3/(t*(t^2-3*t-1)^13),
	(t^4-t^3+5*t^2+t+1)*P13[5]^3/(t^13*(t^2-3*t-1)),
	(t^2+5*t+13)*P13[6]^3/t
	];



Q<x> := PolynomialRing(Integers());
//Q<X> := FunctionField(Rationals());
A2<s,t> := AffineSpace(Rationals(),2);
Summ := [];


/*------------------------------ X_{A_3,G_6}(26) -------------------------------------*/
M6 := Q!(Denominator(J13[6])*Numerator(J13[6]) - 1728*Denominator(J13[6])^2);
Factorization(M6);
C6 := Curve(A2 , s^2 - (t*(t^2 + 6*t + 13)));
ptsC6 := PointSearch(C6,1000);
PC6<S,T,Z> := ProjectiveClosure(C6);
assert (Genus(PC6) eq 1);
pts := Points(PC6);
E6,phi := EllipticCurve(PC6,pts[1]);
assert (Rank(E6) eq 0) and (#TorsionSubgroup(E6) eq 2);
ptsE := RationalPoints(E6 : Bound := 1000);
for P in ptsE do
  Points(P@@phi);
end for;

// X_{A_3,G_6}(26) is a rank 0 elliptic curve with a custodial point and the point at infinity


/*------------------------------ X_{A_3,G_1}(26) -------------------------------------*/
// Not needed since covered by X_{A_3,G_6}(26)

/*------------------------------ X_{A_3,G_2}(26) -------------------------------------*/
// Not needed since covered by X_{A_3,G_6}(26)

/*------------------------------ X_{A_3,G_3}(26) -------------------------------------*/
// Not needed since covered by X_{A_3,G_6}(26)

/*------------------------------ X_{A_3,G_4}(26) -------------------------------------*/
// Not needed since covered by X_{A_3,G_6}(26)

/*------------------------------ X_{A_3,G_5}(26) -------------------------------------*/
// Not needed since covered by X_{A_3,G_6}(26)


/*------------------------------ X_{G_3,N_{ns}}(26) ----------------------------------*/
A3<x,y,s> := AffineSpace(Rationals(),3);
Cns := Scheme(A3, [(-y-1)*x^3 + (2*y^2 + y)*x^2 + (-y^3 + y^2 - 2*y + 1)*x + (2*y^2 - 3*y), 
(y+1)^24*((-y^2-2)^2+(y^2 + 5*y)*x + (-y^2 + y)^14)*(s^2 + 1728) - 
((884736*y^55 + 49489920*y^54 + 1012211712*y^53 + 11898450496*y^52 + 95148841568*y^51 + 
564433986856*y^50 + 2616961812219*y^49 + 9822086693987*y^48 + 30642386133997*y^47 + 81359505328755*y^46 + 188611532400778*y^45 + 392863091096565*y^44 + 750115492349610*y^43 + 1285021297306328*y^42 + 1751719154883360*y^41 + 1150764689309236*y^40 - 2039149007306334*y^39 - 5717108163092124*y^38 + 7099555968682235*y^37 + 77776536294315788*y^36 + 240934894546612597*y^35 + 395125111510297175*y^34 + 89165142545864768*y^33 - 1550321042833254477*y^32 - 
5305245647359351740*y^31 - 10446908162336304678*y^30 - 12871375409731491993*y^29 - 
4395668686472870357*y^28 + 24906193210193909056*y^27 + 81237769117029166717*y^26 + 
161268611204135399411*y^25 + 249955252927207983657*y^24 + 324483552163739360618*y^23 + 
363683177940575393974*y^22 + 358040773388507611446*y^21 + 313163052354472751348*y^20 + 
244627586482873074382*y^19 + 170321443968359565942*y^18 + 105533439538375007957*y^17 + 59274776728757700369*y^16 + 31575303637834908430*y^15 + 16108641614130173307*y^14 + 6982396840373322235*y^13 + 1946153985121206304*y^12 + 125999715600544888*y^11 - 17233649727426000*y^10 + 97243737410324752*y^9 + 60793442160963072*y^8 + 4429798119424768*y^7 - 5098133689396992*y^6 - 508472036045568*y^5 + 376022069526528*y^4 + 11471461152768*y^3 - 15545480048640*y^2 + 1852894310400*y - 67903488000)*x^2 + (-884736*y^56 - 41306112*y^55 - 745311744*y^54 - 7854617152*y^53 - 56752908832*y^52 - 
305691731184*y^51 - 1291334290291*y^50 - 4426288172137*y^49 - 12647728750928*y^48 - 31075240957232*y^47 - 69032547442536*y^46 - 148896176655469*y^45 - 322250360417387*y^44 - 632799187856807*y^43 - 813902597999889*y^42 + 446780681983306*y^41 + 5558180767681622*y^40 + 12861196240238133*y^39 + 82777469121694*y^38 - 95303288589756575*y^37 - 346077988812264244*y^36 - 660107106734655623*y^35 - 436018183788282799*y^34 + 1681210077303367073*y^33 + 7273388110177545277*y^32 + 16144187701672166507*y^31 + 23113156489251424786*y^30 + 
15841883577593033385*y^29 - 22985886157655295827*y^28 - 107891300530866582629*y^27 + 
240236673343003218988*y^26 - 401070259854975037146*y^25 - 553221859660242994706*y^24 - 
655402208407230091461*y^23 - 681436550533356290765*y^22 - 630169426685781559948*y^21 - 521000422369504316094*y^20 - 384796397343162994888*y^19 - 255121295576640474717*y^18 - 155328774650536353143*y^17 - 88765501587983950847*y^16 - 45750129339254668296*y^15 - 18659682247552136243*y^14 - 5068590639242514778*y^13 - 1175381774283273326*y^12 + 905896315537604416*y^11 - 627696074121250176*y^10 - 142339763530459808*y^9 + 40822149606469600*y^8 + 17042318686921728*y^7 - 4711676288999168*y^6 - 1772235425484288*y^5 + 359764019596800*y^4 + 59190591062016*y^3 - 21787540807680*y^2 + 2089099468800*y - 67931136000)*x + (1769472*y^55 + 81727488*y^54 + 1448432640*y^53 + 14896074368*y^52 + 104157512704*y^51 + 536681652096*y^50 + 2133314691734*y^49 + 6717439350959*y^48 + 17014862466548*y^47 + 35253668331292*y^46 + 62993289306098*y^45 + 112164904174479*y^44 + 225104747950936*y^43 + 392976024258106*y^42 + 41136059444059*y^41 - 3005798979372973*y^40 - 11839374362691297*y^39 - 21190199356139685*y^38 + 6071591688951686*y^37 + 156325146877196166*y^36 + 
498229160275748461*y^35 + 823122591905419376*y^34 + 242278135736846249*y^33 - 
2876324971563594929*y^32 - 9820974562808688564*y^31 - 19019630528554710562*y^30 - 
23294749281381561713*y^29 - 9486631575477114590*y^28 + 36945136929714190121*y^27 + 
122510790902234508091*y^26 + 237163604354617256618*y^25 + 354702102863369258879*y^24 + 
443147794960495122187*y^23 + 477688281307028925796*y^22 + 450443978678593045613*y^21 + 
374770111259894186150*y^20 + 278602970647572826148*y^19 + 187430241355450245572*y^18 + 
113084138555091016698*y^17 + 58445464663933323835*y^16 + 24688966627452318352*y^15 + 
9359950076743879942*y^14 + 4515705377792888754*y^13 + 2518265993855063344*y^12 + 
865069239507223888*y^11 - 38745965042080*y^10 - 90275758453065632*y^9 + 96762513188096*y^8 + 14322780344679936*y^7 + 1383116431053312*y^6 - 986975640101376*y^5 - 23199406829568*y^4 + 43522275594240*y^3 - 5384442470400*y^2 + 203793408000*y))]);
PC1<X,Y,S,Z> := Curve(ProjectiveClosure(C1));
Genus(PC1);

/*------------------------------ X_{G_3,N_{s}}(26) ----------------------------------*/
A3<x,y,s> := AffineSpace(Rationals(),3);
Cs := Scheme(A3, [(-y-1)*x^3 + (2*y^2 + y)*x^2 + (-y^3 + y^2 - 2*y + 1)*x + (2*y^2 - 3*y), 
(x^2*y + x^2 - x-1)^13*(s^2 + 1728) - ((y^44 - 478*y^43 - 32789*y^42 - 762363*y^41 - 7547176*y^40 - 29112957*y^39 + 27142557*y^38 + 516914701*y^37 + 812780834*y^36 - 3217396462*y^35 - 9372779891*y^34 + 10412400391*y^33 + 51281877696*y^32 - 21282455533*y^31 - 192026183004*y^30 + 36250779915*y^29 + 569052119000*y^28 - 70791418862*y^27 - 1392885057099*y^26 + 180780916888*y^25 + 2828775392943*y^24 - 
517934371345*y^23 - 4803267109749*y^22 + 1263736631868*y^21 + 6827480292072*y^20 - 
2364214517403*y^19 - 8006349554252*y^18 + 3419622432067*y^17 + 7623483793639*y^16 - 
3825699399717*y^15 - 5822086727508*y^14 + 3183399803606*y^13 + 3469776050052*y^12 - 
1874600063602*y^11 - 1524399772882*y^10 + 753079641994*y^9 + 455793324718*y^8 - 201254434444*y^7 - 83894215212*y^6 + 34538107094*y^5 + 8027212027*y^4 - 3468719981*y^3 - 204764859*y^2 + 159120623*y - 12145116)*x^2 + (y^45 + 446*y^44 + 27904*y^43 + 571184*y^42 + 4618918*y^41 + 10200852*y^40 - 54213498*y^39 - 267763439*y^38 + 165832967*y^37 + 2368932904*y^36 + 395119701*y^35 - 12956472125*y^34 - 4150166662*y^33 + 53633145847*y^32 + 12575521646*y^31 - 180183851743*y^30 - 10692143892*y^29 + 494822838826*y^28 - 75462285877*y^27 - 1111012707457*y^26 + 427597488033*y^25 + 
2035065625744*y^24 - 1283704039956*y^23 - 2989648304276*y^22 + 2716215586599*y^21 + 
3407000739960*y^20 - 4339306349468*y^19 - 2827171518873*y^18 + 5300271455330*y^17 + 
1407694779775*y^16 - 4900196317351*y^15 + 18526414704*y^14 + 3345715118980*y^13 - 
643829576586*y^12 - 1623126310814*y^11 + 509263027702*y^10 + 527959900322*y^9 - 203278262234*y^8 - 104991650269*y^7 + 45780617674*y^6 + 10651697173*y^5 - 5549670458*y^4 - 270006722*y^3 + 269295673*y^2 - 26210553*y - 144612)*x - (2*y^44 - 891*y^43 - 55361*y^42 - 1113897*y^41 - 8622455*y^40 - 14660030*y^39 + 130330785*y^38 + 526492528*y^37 - 657396776*y^36 - 5427279992*y^35 + 569333662*y^34 + 32403186745*y^33 + 8217537249*y^32 - 137416119935*y^31 - 44405672291*y^30 + 459234305539*y^29 + 16561534270*y^28 - 1261675920964*y^27 - 154320890766*y^26 + 2870046210200*y^25 - 102772109156*y^24 - 
5399242483910*y^23 + 1112801469826*y^22 + 8364611871299*y^21 - 3167545239322*y^20 - 
10526258387861*y^19 + 5800415621050*y^18 + 10505818581326*y^17 - 7693864828631*y^16 - 
8045599613602*y^15 + 7523007777896*y^14 + 4507918282558*y^13 - 5289650276066*y^12 -
1710818708766*y^11 + 2566391186088*y^10 + 370366462290*y^9 - 818009316691*y^8 - 14872094943*y^7 +160086948432*y^6 - 12957280360*y^5 - 16931385812*y^4 + 2913054190*y^3 + 664153911*y^2 - 193921364*y + 12288000))]);
PCs<X,Y,S,Z> := Curve(ProjectiveClosure(Cs));

